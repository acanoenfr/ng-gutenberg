{"version":3,"sources":["@wordpress/nux/src/components/dot-tip/index.js"],"names":["compose","Popover","Button","IconButton","__","withSelect","withDispatch","useCallback","useRef","getAnchorRect","anchor","parentNode","getBoundingClientRect","onClick","event","stopPropagation","DotTip","position","children","isVisible","hasNextTip","onDismiss","onDisable","anchorParent","getAnchorRectCallback","current","onFocusOutsideCallback","contains","relatedTarget","select","tipId","isTipVisible","getAssociatedGuide","associatedGuide","nextTipId","dispatch","dismissTip","disableTips"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { Popover, Button, IconButton } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { useCallback, useRef } from '@wordpress/element';\n\nfunction getAnchorRect( anchor ) {\n\t// The default getAnchorRect() excludes an element's top and bottom padding\n\t// from its calculation. We want tips to point to the outer margin of an\n\t// element, so we override getAnchorRect() to include all padding.\n\treturn anchor.parentNode.getBoundingClientRect();\n}\n\nfunction onClick( event ) {\n\t// Tips are often nested within buttons. We stop propagation so that clicking\n\t// on a tip doesn't result in the button being clicked.\n\tevent.stopPropagation();\n}\n\nexport function DotTip( {\n\tposition = 'middle right',\n\tchildren,\n\tisVisible,\n\thasNextTip,\n\tonDismiss,\n\tonDisable,\n} ) {\n\tconst anchorParent = useRef( null );\n\tconst getAnchorRectCallback = useCallback(\n\t\t( anchor ) => {\n\t\t\tanchorParent.current = anchor.parentNode;\n\t\t\treturn getAnchorRect( anchor );\n\t\t},\n\t\t[ anchorParent ]\n\t);\n\tconst onFocusOutsideCallback = useCallback(\n\t\t( event ) => {\n\t\t\tif ( ! anchorParent.current ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( anchorParent.current.contains( event.relatedTarget ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tonDisable();\n\t\t},\n\t\t[ onDisable, anchorParent ]\n\t);\n\tif ( ! isVisible ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Popover\n\t\t\tclassName=\"nux-dot-tip\"\n\t\t\tposition={ position }\n\t\t\tnoArrow\n\t\t\tfocusOnMount=\"container\"\n\t\t\tgetAnchorRect={ getAnchorRectCallback }\n\t\t\trole=\"dialog\"\n\t\t\taria-label={ __( 'Editor tips' ) }\n\t\t\tonClick={ onClick }\n\t\t\tonFocusOutside={ onFocusOutsideCallback }\n\t\t>\n\t\t\t<p>{ children }</p>\n\t\t\t<p>\n\t\t\t\t<Button isLink onClick={ onDismiss }>\n\t\t\t\t\t{ hasNextTip ? __( 'See next tip' ) : __( 'Got it' ) }\n\t\t\t\t</Button>\n\t\t\t</p>\n\t\t\t<IconButton\n\t\t\t\tclassName=\"nux-dot-tip__disable\"\n\t\t\t\ticon=\"no-alt\"\n\t\t\t\tlabel={ __( 'Disable tips' ) }\n\t\t\t\tonClick={ onDisable }\n\t\t\t/>\n\t\t</Popover>\n\t);\n}\n\nexport default compose(\n\twithSelect( ( select, { tipId } ) => {\n\t\tconst { isTipVisible, getAssociatedGuide } = select( 'core/nux' );\n\t\tconst associatedGuide = getAssociatedGuide( tipId );\n\t\treturn {\n\t\t\tisVisible: isTipVisible( tipId ),\n\t\t\thasNextTip: !! ( associatedGuide && associatedGuide.nextTipId ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { tipId } ) => {\n\t\tconst { dismissTip, disableTips } = dispatch( 'core/nux' );\n\t\treturn {\n\t\t\tonDismiss() {\n\t\t\t\tdismissTip( tipId );\n\t\t\t},\n\t\t\tonDisable() {\n\t\t\t\tdisableTips();\n\t\t\t},\n\t\t};\n\t} ),\n)( DotTip );\n"]}