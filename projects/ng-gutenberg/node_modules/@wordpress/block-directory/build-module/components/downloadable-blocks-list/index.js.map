{"version":3,"sources":["@wordpress/block-directory/src/components/downloadable-blocks-list/index.js"],"names":["noop","getBlockMenuDefaultClassName","unregisterBlockType","withDispatch","compose","__","DownloadableBlockListItem","DOWNLOAD_ERROR_NOTICE_ID","INSTALL_ERROR_NOTICE_ID","DownloadableBlocksList","items","onHover","children","downloadAndInstallBlock","map","item","id","icons","dispatch","props","installBlock","downloadBlock","createErrorNotice","removeNotice","removeBlocks","onSelect","onDownloadError","actions","label","onClick","onSuccess","createdBlock","onInstallBlockError","clientId","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { getBlockMenuDefaultClassName, unregisterBlockType } from '@wordpress/blocks';\nimport { withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport DownloadableBlockListItem from '../downloadable-block-list-item';\n\nconst DOWNLOAD_ERROR_NOTICE_ID = 'block-download-error';\nconst INSTALL_ERROR_NOTICE_ID = 'block-install-error';\n\nfunction DownloadableBlocksList( { items, onHover = noop, children, downloadAndInstallBlock } ) {\n\treturn (\n\t\t/*\n\t\t * Disable reason: The `list` ARIA role is redundant but\n\t\t * Safari+VoiceOver won't announce the list otherwise.\n\t\t */\n\t\t/* eslint-disable jsx-a11y/no-redundant-roles */\n\t\t<ul role=\"list\" className=\"block-directory-downloadable-blocks-list\">\n\t\t\t{ items && items.map( ( item ) =>\n\t\t\t\t<DownloadableBlockListItem\n\t\t\t\t\tkey={ item.id }\n\t\t\t\t\tclassName={ getBlockMenuDefaultClassName( item.id ) }\n\t\t\t\t\ticons={ item.icons }\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tdownloadAndInstallBlock( item );\n\t\t\t\t\t\tonHover( null );\n\t\t\t\t\t} }\n\t\t\t\t\tonFocus={ () => onHover( item ) }\n\t\t\t\t\tonMouseEnter={ () => onHover( item ) }\n\t\t\t\t\tonMouseLeave={ () => onHover( null ) }\n\t\t\t\t\tonBlur={ () => onHover( null ) }\n\t\t\t\t\titem={ item }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ children }\n\t\t</ul>\n\t\t/* eslint-enable jsx-a11y/no-redundant-roles */\n\t);\n}\n\nexport default compose(\n\twithDispatch( ( dispatch, props ) => {\n\t\tconst { installBlock, downloadBlock } = dispatch( 'core/block-directory' );\n\t\tconst { createErrorNotice, removeNotice } = dispatch( 'core/notices' );\n\t\tconst { removeBlocks } = dispatch( 'core/block-editor' );\n\t\tconst { onSelect } = props;\n\n\t\treturn {\n\t\t\tdownloadAndInstallBlock: ( item ) => {\n\t\t\t\tconst onDownloadError = () => {\n\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t__( 'Block previews canâ€™t load.' ),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: DOWNLOAD_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\tremoveNotice( DOWNLOAD_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t} );\n\t\t\t\t};\n\n\t\t\t\tconst onSuccess = () => {\n\t\t\t\t\tconst createdBlock = onSelect( item );\n\n\t\t\t\t\tconst onInstallBlockError = () => {\n\t\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t\t__( 'Block previews can\\'t install.' ),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: INSTALL_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice( INSTALL_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Remove' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice( INSTALL_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\t\tremoveBlocks( createdBlock.clientId );\n\t\t\t\t\t\t\t\t\t\t\tunregisterBlockType( item.name );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\n\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t};\n\n\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t},\n\t\t};\n\t} ),\n)( DownloadableBlocksList );\n"]}