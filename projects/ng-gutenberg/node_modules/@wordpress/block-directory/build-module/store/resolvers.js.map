{"version":3,"sources":["@wordpress/block-directory/src/store/resolvers.js"],"names":["camelCase","mapKeys","apiFetch","fetchDownloadableBlocks","receiveDownloadableBlocks","setInstallBlocksPermission","getDownloadableBlocks","filterValue","path","results","blocks","map","result","value","key","code","hasInstallBlocksPermission"],"mappings":";;AAAA;;;AAGA,SAASA,SAAT,EAAoBC,OAApB,QAAmC,QAAnC;AAEA;;;;AAGA,SAASC,QAAT,QAAyB,YAAzB;AACA,SAASC,uBAAT,EAAkCC,yBAAlC,EAA6DC,0BAA7D,QAA+F,WAA/F;AAEA,eAAe;AACZC,EAAAA,qBADY;AAAA;AAAA,0DACWC,WADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAENA,WAFM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAOZ,mBAAMJ,uBAAuB,CAAEI,WAAF,CAA7B;;AAPY;AAAA;AAQI,mBAAML,QAAQ,CAAE;AAC/BM,cAAAA,IAAI,uDAAiDD,WAAjD;AAD2B,aAAF,CAAd;;AARJ;AAQNE,YAAAA,OARM;AAWNC,YAAAA,MAXM,GAWGD,OAAO,CAACE,GAAR,CAAa,UAAEC,MAAF;AAAA,qBAAcX,OAAO,CAAEW,MAAF,EAAU,UAAEC,KAAF,EAASC,GAAT,EAAkB;AAC5E,uBAAOd,SAAS,CAAEc,GAAF,CAAhB;AACA,eAFgD,CAArB;AAAA,aAAb,CAXH;AAAA;AAeZ,mBAAMV,yBAAyB,CAAEM,MAAF,EAAUH,WAAV,CAA/B;;AAfY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBAiBP,YAAMQ,IAAN,KAAe,uBAjBR;AAAA;AAAA;AAAA;;AAAA;AAkBX,mBAAMV,0BAA0B,CAAE,KAAF,CAAhC;;AAlBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsBZW,EAAAA,0BAtBY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwBZ,mBAAMd,QAAQ,CAAE;AACfM,cAAAA,IAAI;AADW,aAAF,CAAd;;AAxBY;AAAA;AA2BZ,mBAAMH,0BAA0B,CAAE,IAAF,CAAhC;;AA3BY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBA6BP,aAAMU,IAAN,KAAe,uBA7BR;AAAA;AAAA;AAAA;;AAAA;AA8BX,mBAAMV,0BAA0B,CAAE,KAAF,CAAhC;;AA9BW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { camelCase, mapKeys } from 'lodash';\n\n/**\n * Internal dependencies\n */\nimport { apiFetch } from './controls';\nimport { fetchDownloadableBlocks, receiveDownloadableBlocks, setInstallBlocksPermission } from './actions';\n\nexport default {\n\t* getDownloadableBlocks( filterValue ) {\n\t\tif ( ! filterValue ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tyield fetchDownloadableBlocks( filterValue );\n\t\t\tconst results = yield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=${ filterValue }`,\n\t\t\t} );\n\t\t\tconst blocks = results.map( ( result ) => mapKeys( result, ( value, key ) => {\n\t\t\t\treturn camelCase( key );\n\t\t\t} ) );\n\n\t\t\tyield receiveDownloadableBlocks( blocks, filterValue );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n\t* hasInstallBlocksPermission() {\n\t\ttry {\n\t\t\tyield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=`,\n\t\t\t} );\n\t\t\tyield setInstallBlocksPermission( true );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n};\n"]}