{"version":3,"sources":["@wordpress/block-directory/src/components/downloadable-blocks-list/index.js"],"names":["DOWNLOAD_ERROR_NOTICE_ID","INSTALL_ERROR_NOTICE_ID","DownloadableBlocksList","items","onHover","noop","children","downloadAndInstallBlock","map","item","id","icons","dispatch","props","installBlock","downloadBlock","createErrorNotice","removeNotice","removeBlocks","onSelect","onDownloadError","actions","label","onClick","onSuccess","createdBlock","onInstallBlockError","clientId","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { getBlockMenuDefaultClassName, unregisterBlockType } from '@wordpress/blocks';\nimport { withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport DownloadableBlockListItem from '../downloadable-block-list-item';\n\nconst DOWNLOAD_ERROR_NOTICE_ID = 'block-download-error';\nconst INSTALL_ERROR_NOTICE_ID = 'block-install-error';\n\nfunction DownloadableBlocksList( { items, onHover = noop, children, downloadAndInstallBlock } ) {\n\treturn (\n\t\t/*\n\t\t * Disable reason: The `list` ARIA role is redundant but\n\t\t * Safari+VoiceOver won't announce the list otherwise.\n\t\t */\n\t\t/* eslint-disable jsx-a11y/no-redundant-roles */\n\t\t<ul role=\"list\" className=\"block-directory-downloadable-blocks-list\">\n\t\t\t{ items && items.map( ( item ) =>\n\t\t\t\t<DownloadableBlockListItem\n\t\t\t\t\tkey={ item.id }\n\t\t\t\t\tclassName={ getBlockMenuDefaultClassName( item.id ) }\n\t\t\t\t\ticons={ item.icons }\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tdownloadAndInstallBlock( item );\n\t\t\t\t\t\tonHover( null );\n\t\t\t\t\t} }\n\t\t\t\t\tonFocus={ () => onHover( item ) }\n\t\t\t\t\tonMouseEnter={ () => onHover( item ) }\n\t\t\t\t\tonMouseLeave={ () => onHover( null ) }\n\t\t\t\t\tonBlur={ () => onHover( null ) }\n\t\t\t\t\titem={ item }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ children }\n\t\t</ul>\n\t\t/* eslint-enable jsx-a11y/no-redundant-roles */\n\t);\n}\n\nexport default compose(\n\twithDispatch( ( dispatch, props ) => {\n\t\tconst { installBlock, downloadBlock } = dispatch( 'core/block-directory' );\n\t\tconst { createErrorNotice, removeNotice } = dispatch( 'core/notices' );\n\t\tconst { removeBlocks } = dispatch( 'core/block-editor' );\n\t\tconst { onSelect } = props;\n\n\t\treturn {\n\t\t\tdownloadAndInstallBlock: ( item ) => {\n\t\t\t\tconst onDownloadError = () => {\n\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t__( 'Block previews canâ€™t load.' ),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: DOWNLOAD_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\tremoveNotice( DOWNLOAD_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t} );\n\t\t\t\t};\n\n\t\t\t\tconst onSuccess = () => {\n\t\t\t\t\tconst createdBlock = onSelect( item );\n\n\t\t\t\t\tconst onInstallBlockError = () => {\n\t\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t\t__( 'Block previews can\\'t install.' ),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: INSTALL_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice( INSTALL_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Remove' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice( INSTALL_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\t\t\tremoveBlocks( createdBlock.clientId );\n\t\t\t\t\t\t\t\t\t\t\tunregisterBlockType( item.name );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\n\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t};\n\n\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t},\n\t\t};\n\t} ),\n)( DownloadableBlocksList );\n"]}