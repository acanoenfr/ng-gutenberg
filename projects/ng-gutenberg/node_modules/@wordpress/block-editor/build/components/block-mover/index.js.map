{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.js"],"names":["BlockMover","arguments","state","isFocused","onFocus","bind","onBlur","setState","props","onMoveUp","onMoveDown","isFirst","isLast","isDraggable","onDragStart","onDragEnd","clientIds","blockElementId","blockType","firstIndex","isLocked","instanceId","isHidden","rootClientId","blocksCount","length","upArrow","dragHandle","downArrow","title","Component","select","getBlock","getBlockIndex","getTemplateLock","getBlockRootClientId","getBlockOrder","normalizedClientIds","firstClientId","block","blockOrder","lastIndex","name","dispatch","moveBlocksDown","moveBlocksUp","withInstanceId"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, partial, castArray } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { IconButton } from '@wordpress/components';\nimport { getBlockType } from '@wordpress/blocks';\nimport { Component } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { getBlockMoverDescription } from './mover-description';\nimport { upArrow, downArrow, dragHandle } from './icons';\nimport { IconDragHandle } from './drag-handle';\n\nexport class BlockMover extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisFocused: false,\n\t\t};\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.onBlur = this.onBlur.bind( this );\n\t}\n\n\tonFocus() {\n\t\tthis.setState( {\n\t\t\tisFocused: true,\n\t\t} );\n\t}\n\n\tonBlur() {\n\t\tthis.setState( {\n\t\t\tisFocused: false,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { onMoveUp, onMoveDown, isFirst, isLast, isDraggable, onDragStart, onDragEnd, clientIds, blockElementId, blockType, firstIndex, isLocked, instanceId, isHidden, rootClientId } = this.props;\n\t\tconst { isFocused } = this.state;\n\t\tconst blocksCount = castArray( clientIds ).length;\n\t\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// We emulate a disabled state because forcefully applying the `disabled`\n\t\t// attribute on the button while it has focus causes the screen to change\n\t\t// to an unfocused state (body as active element) without firing blur on,\n\t\t// the rendering parent, leaving it unable to react to focus out.\n\t\treturn (\n\t\t\t<div className={ classnames( 'editor-block-mover block-editor-block-mover', { 'is-visible': isFocused || ! isHidden } ) }>\n\t\t\t\t<IconButton\n\t\t\t\t\tclassName=\"editor-block-mover__control block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isFirst ? null : onMoveUp }\n\t\t\t\t\ticon={ upArrow }\n\t\t\t\t\tlabel={ __( 'Move up' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__up-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isFirst }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\t\t\t\t<IconDragHandle\n\t\t\t\t\tclassName=\"editor-block-mover__control block-editor-block-mover__control\"\n\t\t\t\t\ticon={ dragHandle }\n\t\t\t\t\tclientId={ clientIds }\n\t\t\t\t\tblockElementId={ blockElementId }\n\t\t\t\t\tisVisible={ isDraggable }\n\t\t\t\t\tonDragStart={ onDragStart }\n\t\t\t\t\tonDragEnd={ onDragEnd }\n\t\t\t\t/>\n\t\t\t\t<IconButton\n\t\t\t\t\tclassName=\"editor-block-mover__control block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isLast ? null : onMoveDown }\n\t\t\t\t\ticon={ downArrow }\n\t\t\t\t\tlabel={ __( 'Move down' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__down-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isLast }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\t\t\t\t<span id={ `block-editor-block-mover__up-description-${ instanceId }` } className=\"editor-block-mover__description block-editor-block-mover__description\">\n\t\t\t\t\t{\n\t\t\t\t\t\tgetBlockMoverDescription(\n\t\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</span>\n\t\t\t\t<span id={ `block-editor-block-mover__down-description-${ instanceId }` } className=\"editor-block-mover__description block-editor-block-mover__description\">\n\t\t\t\t\t{\n\t\t\t\t\t\tgetBlockMoverDescription(\n\t\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst { getBlock, getBlockIndex, getTemplateLock, getBlockRootClientId, getBlockOrder } = select( 'core/block-editor' );\n\t\tconst normalizedClientIds = castArray( clientIds );\n\t\tconst firstClientId = first( normalizedClientIds );\n\t\tconst block = getBlock( firstClientId );\n\t\tconst rootClientId = getBlockRootClientId( first( normalizedClientIds ) );\n\t\tconst blockOrder = getBlockOrder( rootClientId );\n\t\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\t\tconst lastIndex = getBlockIndex( last( normalizedClientIds ), rootClientId );\n\n\t\treturn {\n\t\t\tblockType: block ? getBlockType( block.name ) : null,\n\t\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\t\trootClientId,\n\t\t\tfirstIndex,\n\t\t\tisFirst: firstIndex === 0,\n\t\t\tisLast: lastIndex === blockOrder.length - 1,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientIds, rootClientId } ) => {\n\t\tconst { moveBlocksDown, moveBlocksUp } = dispatch( 'core/block-editor' );\n\t\treturn {\n\t\t\tonMoveDown: partial( moveBlocksDown, clientIds, rootClientId ),\n\t\t\tonMoveUp: partial( moveBlocksUp, clientIds, rootClientId ),\n\t\t};\n\t} ),\n\twithInstanceId,\n)( BlockMover );\n"]}