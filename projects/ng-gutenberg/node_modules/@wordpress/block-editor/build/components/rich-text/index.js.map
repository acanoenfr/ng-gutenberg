{"version":3,"sources":["@wordpress/block-editor/src/components/rich-text/index.js"],"names":["requestIdleCallback","window","fallbackRequestIdleCallback","fn","setTimeout","wrapperClasses","classes","getMultilineTag","multiline","RichTextWrapper","arguments","onEnter","bind","onSplit","onPaste","onDelete","inputRule","markAutomaticChange","value","onChange","shiftKey","props","onReplace","canSplit","transforms","filter","type","transformation","item","regExp","test","text","transform","content","isReverse","onMerge","onRemove","html","plainText","image","tagName","canUserUseUnfilteredHTML","__unstableEmbedURLOnPaste","file","getAsFile","HTML","mode","console","log","trim","valueToInsert","LINE_SEPARATOR","length","record","pastedBlocks","onSplitMiddle","__unstableOnSplitMiddle","blocks","before","after","hasPastedBlocks","multilineTag","push","indexToSelect","valueToFormat","start","characterBefore","slice","trimmedTextBefore","prefixTransforms","prefix","block","allowedFormats","formattingControls","alternative","map","name","children","originalValue","originalOnChange","selectionStart","selectionEnd","onSelectionChange","inlineToolbar","wrapperClassName","className","autocompleters","isCaretWithinFormattedText","onEnterFormattedText","onExitFormattedText","originalIsSelected","isSelected","onCreateUndoLevel","didAutomaticChange","undo","placeholder","keepPlaceholderOnFocus","withoutInteractiveFormatting","clientId","identifier","instanceId","reversed","experimentalProps","adjustedAllowedFormats","getAllowedFormats","hasFormats","adjustedValue","adjustedOnChange","Array","isArray","childrenSource","toHTML","newValue","fromDOM","document","childNodes","Editable","listBoxId","activeId","onKeyDown","undefined","Component","RichTextContainer","withInstanceId","select","getSelectionStart","getSelectionEnd","getSettings","__experimentalCanUserUseUnfilteredHTML","attributeKey","offset","dispatch","__unstableMarkLastChangeAsPersistent","enterFormattedText","exitFormattedText","selectionChange","__unstableMarkAutomaticChange","end","Content","Tag","MultilineTag","isEmpty","defaultProps","format"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { RawHTML, Component } from '@wordpress/element';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { pasteHandler, children as childrenSource, getBlockTransforms, findTransform } from '@wordpress/blocks';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport {\n\t__experimentalRichText as RichText,\n\t__unstableCreateElement,\n\tisEmpty,\n\t__unstableIsEmptyLine as isEmptyLine,\n\tinsert,\n\t__unstableInsertLineSeparator as insertLineSeparator,\n\tcreate,\n\treplace,\n\tsplit,\n\t__UNSTABLE_LINE_SEPARATOR as LINE_SEPARATOR,\n\ttoHTMLString,\n\tslice,\n} from '@wordpress/rich-text';\nimport { withFilters, IsolatedEventContainer } from '@wordpress/components';\nimport { createBlobURL } from '@wordpress/blob';\nimport deprecated from '@wordpress/deprecated';\nimport { isURL } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport Autocomplete from '../autocomplete';\nimport BlockFormatControls from '../block-format-controls';\nimport FormatToolbar from './format-toolbar';\nimport { withBlockEditContext } from '../block-edit/context';\nimport { RemoveBrowserShortcuts } from './remove-browser-shortcuts';\n\nconst requestIdleCallback = window.requestIdleCallback ||\n\tfunction fallbackRequestIdleCallback( fn ) {\n\t\twindow.setTimeout( fn, 100 );\n\t};\n\nconst wrapperClasses = 'editor-rich-text block-editor-rich-text';\nconst classes = 'editor-rich-text__editable block-editor-rich-text__editable';\n\n/**\n * Get the multiline tag based on the multiline prop.\n *\n * @param {?(string|boolean)} multiline The multiline prop.\n *\n * @return {?string} The multiline tag.\n */\nfunction getMultilineTag( multiline ) {\n\tif ( multiline !== true && multiline !== 'p' && multiline !== 'li' ) {\n\t\treturn;\n\t}\n\n\treturn multiline === true ? 'p' : multiline;\n}\n\nclass RichTextWrapper extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onEnter = this.onEnter.bind( this );\n\t\tthis.onSplit = this.onSplit.bind( this );\n\t\tthis.onPaste = this.onPaste.bind( this );\n\t\tthis.onDelete = this.onDelete.bind( this );\n\t\tthis.inputRule = this.inputRule.bind( this );\n\t\tthis.markAutomaticChange = this.markAutomaticChange.bind( this );\n\t}\n\n\tonEnter( { value, onChange, shiftKey } ) {\n\t\tconst { onReplace, onSplit, multiline } = this.props;\n\t\tconst canSplit = onReplace && onSplit;\n\n\t\tif ( onReplace ) {\n\t\t\tconst transforms = getBlockTransforms( 'from' )\n\t\t\t\t.filter( ( { type } ) => type === 'enter' );\n\t\t\tconst transformation = findTransform( transforms, ( item ) => {\n\t\t\t\treturn item.regExp.test( value.text );\n\t\t\t} );\n\n\t\t\tif ( transformation ) {\n\t\t\t\tonReplace( [\n\t\t\t\t\ttransformation.transform( { content: value.text } ),\n\t\t\t\t] );\n\t\t\t\tthis.markAutomaticChange();\n\t\t\t}\n\t\t}\n\n\t\tif ( multiline ) {\n\t\t\tif ( shiftKey ) {\n\t\t\t\tonChange( insert( value, '\\n' ) );\n\t\t\t} else if ( canSplit && isEmptyLine( value ) ) {\n\t\t\t\tthis.onSplit( value );\n\t\t\t} else {\n\t\t\t\tonChange( insertLineSeparator( value ) );\n\t\t\t}\n\t\t} else if ( shiftKey || ! canSplit ) {\n\t\t\tonChange( insert( value, '\\n' ) );\n\t\t} else {\n\t\t\tthis.onSplit( value );\n\t\t}\n\t}\n\n\tonDelete( { value, isReverse } ) {\n\t\tconst { onMerge, onRemove } = this.props;\n\n\t\tif ( onMerge ) {\n\t\t\tonMerge( ! isReverse );\n\t\t}\n\n\t\t// Only handle remove on Backspace. This serves dual-purpose of being\n\t\t// an intentional user interaction distinguishing between Backspace and\n\t\t// Delete to remove the empty field, but also to avoid merge & remove\n\t\t// causing destruction of two fields (merge, then removed merged).\n\t\tif ( onRemove && isEmpty( value ) && isReverse ) {\n\t\t\tonRemove( ! isReverse );\n\t\t}\n\t}\n\n\tonPaste( { value, onChange, html, plainText, image } ) {\n\t\tconst {\n\t\t\tonReplace,\n\t\t\tonSplit,\n\t\t\ttagName,\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t\tmultiline,\n\t\t\t__unstableEmbedURLOnPaste,\n\t\t} = this.props;\n\n\t\tif ( image && ! html ) {\n\t\t\tconst file = image.getAsFile ? image.getAsFile() : image;\n\t\t\tconst content = pasteHandler( {\n\t\t\t\tHTML: `<img src=\"${ createBlobURL( file ) }\">`,\n\t\t\t\tmode: 'BLOCKS',\n\t\t\t\ttagName,\n\t\t\t} );\n\n\t\t\t// Allows us to ask for this information when we get a report.\n\t\t\twindow.console.log( 'Received item:\\n\\n', file );\n\n\t\t\tif ( onReplace && isEmpty( value ) ) {\n\t\t\t\tonReplace( content );\n\t\t\t} else {\n\t\t\t\tthis.onSplit( value, content );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet mode = onReplace && onSplit ? 'AUTO' : 'INLINE';\n\n\t\tif (\n\t\t\t__unstableEmbedURLOnPaste &&\n\t\t\tisEmpty( value ) &&\n\t\t\tisURL( plainText.trim() )\n\t\t) {\n\t\t\tmode = 'BLOCKS';\n\t\t}\n\n\t\tconst content = pasteHandler( {\n\t\t\tHTML: html,\n\t\t\tplainText,\n\t\t\tmode,\n\t\t\ttagName,\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t} );\n\n\t\tif ( typeof content === 'string' ) {\n\t\t\tlet valueToInsert = create( { html: content } );\n\n\t\t\t// If the content should be multiline, we should process text\n\t\t\t// separated by a line break as separate lines.\n\t\t\tif ( multiline ) {\n\t\t\t\tvalueToInsert = replace( valueToInsert, /\\n+/g, LINE_SEPARATOR );\n\t\t\t}\n\n\t\t\tonChange( insert( value, valueToInsert ) );\n\t\t} else if ( content.length > 0 ) {\n\t\t\tif ( onReplace && isEmpty( value ) ) {\n\t\t\t\tonReplace( content );\n\t\t\t} else {\n\t\t\t\tthis.onSplit( value, content );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Signals to the RichText owner that the block can be replaced with two\n\t * blocks as a result of splitting the block by pressing enter, or with\n\t * blocks as a result of splitting the block by pasting block content in the\n\t * instance.\n\t *\n\t * @param  {Object} record       The rich text value to split.\n\t * @param  {Array}  pastedBlocks The pasted blocks to insert, if any.\n\t */\n\tonSplit( record, pastedBlocks = [] ) {\n\t\tconst {\n\t\t\tonReplace,\n\t\t\tonSplit,\n\t\t\t__unstableOnSplitMiddle: onSplitMiddle,\n\t\t\tmultiline,\n\t\t} = this.props;\n\n\t\tif ( ! onReplace || ! onSplit ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst blocks = [];\n\t\tconst [ before, after ] = split( record );\n\t\tconst hasPastedBlocks = pastedBlocks.length > 0;\n\t\tconst multilineTag = getMultilineTag( multiline );\n\n\t\t// Create a block with the content before the caret if there's no pasted\n\t\t// blocks, or if there are pasted blocks and the value is not empty.\n\t\t// We do not want a leading empty block on paste, but we do if split\n\t\t// with e.g. the enter key.\n\t\tif ( ! hasPastedBlocks || ! isEmpty( before ) ) {\n\t\t\tblocks.push( onSplit( toHTMLString( {\n\t\t\t\tvalue: before,\n\t\t\t\tmultilineTag,\n\t\t\t} ) ) );\n\t\t}\n\n\t\tif ( hasPastedBlocks ) {\n\t\t\tblocks.push( ...pastedBlocks );\n\t\t} else if ( onSplitMiddle ) {\n\t\t\tblocks.push( onSplitMiddle() );\n\t\t}\n\n\t\t// If there's pasted blocks, append a block with the content after the\n\t\t// caret. Otherwise, do append and empty block if there is no\n\t\t// `onSplitMiddle` prop, but if there is and the content is empty, the\n\t\t// middle block is enough to set focus in.\n\t\tif ( hasPastedBlocks || ! onSplitMiddle || ! isEmpty( after ) ) {\n\t\t\tblocks.push( onSplit( toHTMLString( {\n\t\t\t\tvalue: after,\n\t\t\t\tmultilineTag,\n\t\t\t} ) ) );\n\t\t}\n\n\t\t// If there are pasted blocks, set the selection to the last one.\n\t\t// Otherwise, set the selection to the second block.\n\t\tconst indexToSelect = hasPastedBlocks ? blocks.length - 1 : 1;\n\n\t\tonReplace( blocks, indexToSelect );\n\t}\n\n\tinputRule( value, valueToFormat ) {\n\t\tconst { onReplace } = this.props;\n\n\t\tif ( ! onReplace ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { start, text } = value;\n\t\tconst characterBefore = text.slice( start - 1, start );\n\n\t\t// The character right before the caret must be a plain space.\n\t\tif ( characterBefore !== ' ' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst trimmedTextBefore = text.slice( 0, start ).trim();\n\t\tconst prefixTransforms = getBlockTransforms( 'from' )\n\t\t\t.filter( ( { type } ) => type === 'prefix' );\n\t\tconst transformation = findTransform( prefixTransforms, ( { prefix } ) => {\n\t\t\treturn trimmedTextBefore === prefix;\n\t\t} );\n\n\t\tif ( ! transformation ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst content = valueToFormat( slice( value, start, text.length ) );\n\t\tconst block = transformation.transform( content );\n\n\t\tonReplace( [ block ] );\n\t\tthis.markAutomaticChange();\n\t}\n\n\tgetAllowedFormats() {\n\t\tconst { allowedFormats, formattingControls } = this.props;\n\n\t\tif ( ! allowedFormats && ! formattingControls ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( allowedFormats ) {\n\t\t\treturn allowedFormats;\n\t\t}\n\n\t\tdeprecated( 'wp.blockEditor.RichText formattingControls prop', {\n\t\t\talternative: 'allowedFormats',\n\t\t} );\n\n\t\treturn formattingControls.map( ( name ) => `core/${ name }` );\n\t}\n\n\t/**\n\t * Marks the last change as an automatic change at the next idle period to\n\t * ensure all selection changes have been recorded.\n\t */\n\tmarkAutomaticChange() {\n\t\trequestIdleCallback( () => {\n\t\t\tthis.props.markAutomaticChange();\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tchildren,\n\t\t\ttagName,\n\t\t\tvalue: originalValue,\n\t\t\tonChange: originalOnChange,\n\t\t\tselectionStart,\n\t\t\tselectionEnd,\n\t\t\tonSelectionChange,\n\t\t\tmultiline,\n\t\t\tinlineToolbar,\n\t\t\twrapperClassName,\n\t\t\tclassName,\n\t\t\tautocompleters,\n\t\t\tonReplace,\n\t\t\tisCaretWithinFormattedText,\n\t\t\tonEnterFormattedText,\n\t\t\tonExitFormattedText,\n\t\t\tisSelected: originalIsSelected,\n\t\t\tonCreateUndoLevel,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tmarkAutomaticChange,\n\t\t\tdidAutomaticChange,\n\t\t\tundo,\n\t\t\tplaceholder,\n\t\t\tkeepPlaceholderOnFocus,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tallowedFormats,\n\t\t\twithoutInteractiveFormatting,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tonRemove,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tonMerge,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tonSplit,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tclientId,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tidentifier,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\tinstanceId,\n\t\t\t// To do: find a better way to implicitly inherit props.\n\t\t\tstart,\n\t\t\treversed,\n\t\t\t// From experimental filter. To do: pick props instead.\n\t\t\t...experimentalProps\n\t\t} = this.props;\n\t\tconst multilineTag = getMultilineTag( multiline );\n\n\t\tconst adjustedAllowedFormats = this.getAllowedFormats();\n\t\tconst hasFormats = ! adjustedAllowedFormats || adjustedAllowedFormats.length > 0;\n\t\tlet adjustedValue = originalValue;\n\t\tlet adjustedOnChange = originalOnChange;\n\n\t\t// Handle deprecated format.\n\t\tif ( Array.isArray( originalValue ) ) {\n\t\t\tadjustedValue = childrenSource.toHTML( originalValue );\n\t\t\tadjustedOnChange = ( newValue ) => originalOnChange( childrenSource.fromDOM(\n\t\t\t\t__unstableCreateElement( document, newValue ).childNodes\n\t\t\t) );\n\t\t}\n\n\t\tconst content = (\n\t\t\t<RichText\n\t\t\t\t{ ...experimentalProps }\n\t\t\t\tvalue={ adjustedValue }\n\t\t\t\tonChange={ adjustedOnChange }\n\t\t\t\tselectionStart={ selectionStart }\n\t\t\t\tselectionEnd={ selectionEnd }\n\t\t\t\tonSelectionChange={ onSelectionChange }\n\t\t\t\ttagName={ tagName }\n\t\t\t\tclassName={ classnames( classes, className, {\n\t\t\t\t\t'is-selected': originalIsSelected,\n\t\t\t\t\t'keep-placeholder-on-focus': keepPlaceholderOnFocus,\n\t\t\t\t} ) }\n\t\t\t\tplaceholder={ placeholder }\n\t\t\t\tallowedFormats={ adjustedAllowedFormats }\n\t\t\t\twithoutInteractiveFormatting={ withoutInteractiveFormatting }\n\t\t\t\tonEnter={ this.onEnter }\n\t\t\t\tonDelete={ this.onDelete }\n\t\t\t\tonPaste={ this.onPaste }\n\t\t\t\t__unstableIsSelected={ originalIsSelected }\n\t\t\t\t__unstableInputRule={ this.inputRule }\n\t\t\t\t__unstableMultilineTag={ multilineTag }\n\t\t\t\t__unstableIsCaretWithinFormattedText={ isCaretWithinFormattedText }\n\t\t\t\t__unstableOnEnterFormattedText={ onEnterFormattedText }\n\t\t\t\t__unstableOnExitFormattedText={ onExitFormattedText }\n\t\t\t\t__unstableOnCreateUndoLevel={ onCreateUndoLevel }\n\t\t\t\t__unstableMarkAutomaticChange={ this.markAutomaticChange }\n\t\t\t\t__unstableDidAutomaticChange={ didAutomaticChange }\n\t\t\t\t__unstableUndo={ undo }\n\t\t\t>\n\t\t\t\t{ ( { isSelected, value, onChange, Editable } ) =>\n\t\t\t\t\t<>\n\t\t\t\t\t\t{ children && children( { value, onChange } ) }\n\t\t\t\t\t\t{ isSelected && ! inlineToolbar && hasFormats && (\n\t\t\t\t\t\t\t<BlockFormatControls>\n\t\t\t\t\t\t\t\t<FormatToolbar />\n\t\t\t\t\t\t\t</BlockFormatControls>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ isSelected && inlineToolbar && hasFormats && (\n\t\t\t\t\t\t\t<IsolatedEventContainer\n\t\t\t\t\t\t\t\tclassName=\"editor-rich-text__inline-toolbar block-editor-rich-text__inline-toolbar\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<FormatToolbar />\n\t\t\t\t\t\t\t</IsolatedEventContainer>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ isSelected && <RemoveBrowserShortcuts /> }\n\t\t\t\t\t\t<Autocomplete\n\t\t\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\t\t\tcompleters={ autocompleters }\n\t\t\t\t\t\t\trecord={ value }\n\t\t\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ ( { listBoxId, activeId, onKeyDown } ) =>\n\t\t\t\t\t\t\t\t<Editable\n\t\t\t\t\t\t\t\t\taria-autocomplete={ listBoxId ? 'list' : undefined }\n\t\t\t\t\t\t\t\t\taria-owns={ listBoxId }\n\t\t\t\t\t\t\t\t\taria-activedescendant={ activeId }\n\t\t\t\t\t\t\t\t\tstart={ start }\n\t\t\t\t\t\t\t\t\treversed={ reversed }\n\t\t\t\t\t\t\t\t\tonKeyDown={ onKeyDown }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Autocomplete>\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t</RichText>\n\t\t);\n\n\t\treturn (\n\t\t\t<div className={ classnames( wrapperClasses, wrapperClassName ) }>\n\t\t\t\t{ content }\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst RichTextContainer = compose( [\n\twithInstanceId,\n\twithBlockEditContext( ( { clientId } ) => ( { clientId } ) ),\n\twithSelect( ( select, {\n\t\tclientId,\n\t\tinstanceId,\n\t\tidentifier = instanceId,\n\t\tisSelected,\n\t} ) => {\n\t\tconst {\n\t\t\tisCaretWithinFormattedText,\n\t\t\tgetSelectionStart,\n\t\t\tgetSelectionEnd,\n\t\t\tgetSettings,\n\t\t\tdidAutomaticChange,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst selectionStart = getSelectionStart();\n\t\tconst selectionEnd = getSelectionEnd();\n\t\tconst { __experimentalCanUserUseUnfilteredHTML } = getSettings();\n\t\tif ( isSelected === undefined ) {\n\t\t\tisSelected = (\n\t\t\t\tselectionStart.clientId === clientId &&\n\t\t\t\tselectionStart.attributeKey === identifier\n\t\t\t);\n\t\t} else if ( isSelected ) {\n\t\t\tisSelected = selectionStart.clientId === clientId;\n\t\t}\n\n\t\treturn {\n\t\t\tcanUserUseUnfilteredHTML: __experimentalCanUserUseUnfilteredHTML,\n\t\t\tisCaretWithinFormattedText: isCaretWithinFormattedText(),\n\t\t\tselectionStart: isSelected ? selectionStart.offset : undefined,\n\t\t\tselectionEnd: isSelected ? selectionEnd.offset : undefined,\n\t\t\tisSelected,\n\t\t\tdidAutomaticChange: didAutomaticChange(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, {\n\t\tclientId,\n\t\tinstanceId,\n\t\tidentifier = instanceId,\n\t} ) => {\n\t\tconst {\n\t\t\t__unstableMarkLastChangeAsPersistent,\n\t\t\tenterFormattedText,\n\t\t\texitFormattedText,\n\t\t\tselectionChange,\n\t\t\t__unstableMarkAutomaticChange,\n\t\t} = dispatch( 'core/block-editor' );\n\t\tconst { undo } = dispatch( 'core/editor' );\n\n\t\treturn {\n\t\t\tonCreateUndoLevel: __unstableMarkLastChangeAsPersistent,\n\t\t\tonEnterFormattedText: enterFormattedText,\n\t\t\tonExitFormattedText: exitFormattedText,\n\t\t\tonSelectionChange( start, end ) {\n\t\t\t\tselectionChange( clientId, identifier, start, end );\n\t\t\t},\n\t\t\tmarkAutomaticChange: __unstableMarkAutomaticChange,\n\t\t\tundo,\n\t\t};\n\t} ),\n\twithFilters( 'experimentalRichText' ),\n] )( RichTextWrapper );\n\nRichTextContainer.Content = ( { value, tagName: Tag, multiline, ...props } ) => {\n\t// Handle deprecated `children` and `node` sources.\n\tif ( Array.isArray( value ) ) {\n\t\tvalue = childrenSource.toHTML( value );\n\t}\n\n\tconst MultilineTag = getMultilineTag( multiline );\n\n\tif ( ! value && MultilineTag ) {\n\t\tvalue = `<${ MultilineTag }></${ MultilineTag }>`;\n\t}\n\n\tconst content = <RawHTML>{ value }</RawHTML>;\n\n\tif ( Tag ) {\n\t\treturn <Tag { ...omit( props, [ 'format' ] ) }>{ content }</Tag>;\n\t}\n\n\treturn content;\n};\n\nRichTextContainer.isEmpty = ( value ) => {\n\treturn ! value || value.length === 0;\n};\n\nRichTextContainer.Content.defaultProps = {\n\tformat: 'string',\n\tvalue: '',\n};\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/master/packages/block-editor/src/components/rich-text/README.md\n */\nexport default RichTextContainer;\nexport { RichTextShortcut } from './shortcut';\nexport { RichTextToolbarButton } from './toolbar-button';\nexport { __unstableRichTextInputEvent } from './input-event';\n"]}