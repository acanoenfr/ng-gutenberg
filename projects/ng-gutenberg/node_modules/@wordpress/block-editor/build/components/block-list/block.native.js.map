{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block.native.js"],"names":["BlockListBlock","arguments","insertBlocksAfter","bind","onFocus","state","isFullyBordered","props","isSelected","onSelect","blocks","onInsertBlocks","order","clientId","name","attributes","onChange","onReplace","mergeBlocks","onCaretVerticalPositionChange","styles","blockTitle","title","getAccessibilityLabelExtra","blockName","blockAccessibilityLabel","borderStyle","focusedBorderColor","icon","isValid","showTitle","borderColor","accessibilityLabel","getAccessibilityLabel","blockHolder","renderBlockTitle","blockContainer","blockContainerFocused","getBlockForType","Component","select","rootClientId","getBlockIndex","getBlocks","isBlockSelected","__unstableGetBlockWithoutInnerBlocks","isFirstBlock","isLastBlock","length","block","blockType","__experimentalGetAccessibilityLabel","dispatch","ownProps","insertBlocks","replaceBlocks","selectBlock","updateBlockAttributes","forward","getPreviousBlockClientId","getNextBlockClientId","nextBlockClientId","previousBlockClientId","index","initialPosition","indexToSelect"],"mappings":";;;;;;;;;AAYA;;;;;;;;;;;;;;AATA;;AAUA;;AACA;;AACA;;AACA;;AAKA;;AACA;;AACA;;AACA;;AAxBA;;;;AASA;;;;AASA;;;IAQMA,c;;;;;AACL,4BAAc;AAAA;;AAAA;AACb,qHAAUC,SAAV;AAEA,UAAKC,iBAAL,GAAyB,MAAKA,iBAAL,CAAuBC,IAAvB,6CAAzB;AACA,UAAKC,OAAL,GAAe,MAAKA,OAAL,CAAaD,IAAb,6CAAf;AAEA,UAAKE,KAAL,GAAa;AACZC,MAAAA,eAAe,EAAE;AADL,KAAb;AANa;AASb;;;;8BAES;AACT,UAAK,CAAE,KAAKC,KAAL,CAAWC,UAAlB,EAA+B;AAC9B,aAAKD,KAAL,CAAWE,QAAX;AACA;AACD;;;sCAEkBC,M,EAAS;AAC3B,WAAKH,KAAL,CAAWI,cAAX,CAA2BD,MAA3B,EAAmC,KAAKH,KAAL,CAAWK,KAAX,GAAmB,CAAtD;;AAEA,UAAKF,MAAM,CAAE,CAAF,CAAX,EAAmB;AAClB;AACA,aAAKH,KAAL,CAAWE,QAAX,CAAqBC,MAAM,CAAE,CAAF,CAAN,CAAYG,QAAjC;AACA;AACD;;;sCAEiB;AACjB,aACC,4BAAC,kBAAD;AACC,QAAA,IAAI,EAAG,KAAKN,KAAL,CAAWO,IADnB;AAEC,QAAA,UAAU,EAAG,KAAKP,KAAL,CAAWC,UAFzB;AAGC,QAAA,UAAU,EAAG,KAAKD,KAAL,CAAWQ,UAHzB;AAIC,QAAA,aAAa,EAAG,KAAKR,KAAL,CAAWS,QAJ5B;AAKC,QAAA,OAAO,EAAG,KAAKZ,OALhB;AAMC,QAAA,SAAS,EAAG,KAAKG,KAAL,CAAWU,SANxB;AAOC,QAAA,iBAAiB,EAAG,KAAKf,iBAP1B;AAQC,QAAA,WAAW,EAAG,KAAKK,KAAL,CAAWW,WAR1B;AASC,QAAA,6BAA6B,EAAG,KAAKX,KAAL,CAAWY,6BAT5C;AAUC,QAAA,QAAQ,EAAG,KAAKZ,KAAL,CAAWM;AAVvB,QADD;AAcA;;;uCAEkB;AAClB,aACC,4BAAC,iBAAD;AAAM,QAAA,KAAK,EAAGO,eAAOC;AAArB,SACC,4BAAC,iBAAD,uBAAmB,KAAKd,KAAL,CAAWO,IAA9B,CADD,CADD;AAKA;;;4CAEuB;AAAA,wBACgD,KAAKP,KADrD;AAAA,UACfQ,UADe,eACfA,UADe;AAAA,UACHD,IADG,eACHA,IADG;AAAA,UACGF,KADH,eACGA,KADH;AAAA,UACUU,KADV,eACUA,KADV;AAAA,UACiBC,0BADjB,eACiBA,0BADjB;AAGvB,UAAIC,SAAS,GAAG,EAAhB;;AAEA,UAAKV,IAAI,KAAK,cAAd,EAA+B;AAAE;AAChCU,QAAAA,SAAS,GAAGF,KAAZ;AACA,OAFD,MAEO;AACNE,QAAAA,SAAS,GAAG;AACX;AACA,sBAAI,UAAJ,CAFW,EAGXF,KAHW,CAGJ;AAHI,SAAZ;AAKA;;AAEDE,MAAAA,SAAS,IAAI,OAAO,mBAAS,cAAI,SAAJ,CAAT,EAA0BZ,KAAK,GAAG,CAAlC,CAApB;;AAEA,UAAKW,0BAAL,EAAkC;AACjC,YAAME,uBAAuB,GAAGF,0BAA0B,CAAER,UAAF,CAA1D;AACAS,QAAAA,SAAS,IAAIC,uBAAuB,GAAG,MAAMA,uBAAT,GAAmC,EAAvE;AACA;;AAED,aAAOD,SAAP;AACA;;;6BAEQ;AAAA,yBAUJ,KAAKjB,KAVD;AAAA,UAEPmB,WAFO,gBAEPA,WAFO;AAAA,UAGPb,QAHO,gBAGPA,QAHO;AAAA,UAIPc,kBAJO,gBAIPA,kBAJO;AAAA,UAKPC,IALO,gBAKPA,IALO;AAAA,UAMPpB,UANO,gBAMPA,UANO;AAAA,UAOPqB,OAPO,gBAOPA,OAPO;AAAA,UAQPC,SARO,gBAQPA,SARO;AAAA,UASPR,KATO,gBASPA,KATO;AAYR,UAAMS,WAAW,GAAGvB,UAAU,GAAGmB,kBAAH,GAAwB,aAAtD;AAEA,UAAMK,kBAAkB,GAAG,KAAKC,qBAAL,EAA3B;AAEA,aACC,4BAAC,qCAAD;AACC,QAAA,OAAO,EAAG,KAAK7B,OADhB;AAEC,QAAA,UAAU,EAAG,CAAEI,UAFhB;AAGC,QAAA,iBAAiB,EAAG;AAHrB,SAKC,4BAAC,iBAAD;AAAM,QAAA,KAAK,EAAG,CAAEY,eAAOc,WAAT,EAAsBR,WAAtB,EAAmC;AAAEK,UAAAA,WAAW,EAAXA;AAAF,SAAnC;AAAd,SACGD,SAAS,IAAI,KAAKK,gBAAL,EADhB,EAEC,4BAAC,iBAAD;AACC,QAAA,kBAAkB,EAAGH,kBADtB;AAEC,QAAA,KAAK,EAAG,CAAE,CAAExB,UAAF,IAAgBY,eAAOgB,cAAzB,EAAyC5B,UAAU,IAAIY,eAAOiB,qBAA9D;AAFT,SAIGR,OAAO,IAAI,KAAKS,eAAL,EAJd,EAKG,CAAET,OAAF,IACF,4BAAC,4BAAD;AAAqB,QAAA,UAAU,EAAGP,KAAlC;AAA0C,QAAA,IAAI,EAAGM;AAAjD,QAND,CAFD,EAWGpB,UAAU,IAAI,4BAAC,2BAAD;AAAoB,QAAA,QAAQ,EAAGK;AAA/B,QAXjB,CALD,CADD;AAqBA;;;EAlH2B0B,kB;;eAqHd,sBAAS,CACvB,sBAAY,UAAEC,MAAF,QAA0C;AAAA,MAA9B3B,QAA8B,QAA9BA,QAA8B;AAAA,MAApB4B,YAAoB,QAApBA,YAAoB;;AAAA,gBAMjDD,MAAM,CAAE,mBAAF,CAN2C;AAAA,MAEpDE,aAFoD,WAEpDA,aAFoD;AAAA,MAGpDC,SAHoD,WAGpDA,SAHoD;AAAA,MAIpDC,eAJoD,WAIpDA,eAJoD;AAAA,MAKpDC,oCALoD,WAKpDA,oCALoD;;AAOrD,MAAMjC,KAAK,GAAG8B,aAAa,CAAE7B,QAAF,EAAY4B,YAAZ,CAA3B;AACA,MAAMjC,UAAU,GAAGoC,eAAe,CAAE/B,QAAF,CAAlC;AACA,MAAMiC,YAAY,GAAGlC,KAAK,KAAK,CAA/B;AACA,MAAMmC,WAAW,GAAGnC,KAAK,KAAK+B,SAAS,GAAGK,MAAZ,GAAqB,CAAnD;;AACA,MAAMC,KAAK,GAAGJ,oCAAoC,CAAEhC,QAAF,CAAlD;;AAXqD,cAYfoC,KAAK,IAAI,EAZM;AAAA,MAY7CnC,IAZ6C,SAY7CA,IAZ6C;AAAA,MAYvCC,UAZuC,SAYvCA,UAZuC;AAAA,MAY3Bc,OAZ2B,SAY3BA,OAZ2B;;AAarD,MAAMqB,SAAS,GAAG,0BAAcpC,IAAI,IAAI,cAAtB,CAAlB;AACA,MAAMQ,KAAK,GAAG4B,SAAS,CAAC5B,KAAxB;AACA,MAAMM,IAAI,GAAGsB,SAAS,CAACtB,IAAvB;AACA,MAAML,0BAA0B,GAAG2B,SAAS,CAACC,mCAA7C;AAEA,SAAO;AACNvB,IAAAA,IAAI,EAAJA,IADM;AAENd,IAAAA,IAAI,EAAEA,IAAI,IAAI,cAFR;AAGNF,IAAAA,KAAK,EAALA,KAHM;AAINU,IAAAA,KAAK,EAALA,KAJM;AAKNP,IAAAA,UAAU,EAAVA,UALM;AAMNmC,IAAAA,SAAS,EAATA,SANM;AAONJ,IAAAA,YAAY,EAAZA,YAPM;AAQNC,IAAAA,WAAW,EAAXA,WARM;AASNvC,IAAAA,UAAU,EAAVA,UATM;AAUNqB,IAAAA,OAAO,EAAPA,OAVM;AAWNN,IAAAA,0BAA0B,EAA1BA;AAXM,GAAP;AAaA,CA/BD,CADuB,EAiCvB,wBAAc,UAAE6B,QAAF,EAAYC,QAAZ,SAAsC;AAAA,MAAdb,MAAc,SAAdA,MAAc;;AAAA,kBAO/CY,QAAQ,CAAE,mBAAF,CAPuC;AAAA,MAElDE,YAFkD,aAElDA,YAFkD;AAAA,MAGlDpC,YAHkD,aAGlDA,WAHkD;AAAA,MAIlDqC,aAJkD,aAIlDA,aAJkD;AAAA,MAKlDC,WALkD,aAKlDA,WALkD;AAAA,MAMlDC,qBANkD,aAMlDA,qBANkD;;AASnD,SAAO;AACNvC,IAAAA,WADM,uBACOwC,OADP,EACiB;AAAA,UACd7C,QADc,GACDwC,QADC,CACdxC,QADc;;AAAA,qBAKlB2B,MAAM,CAAE,mBAAF,CALY;AAAA,UAGrBmB,wBAHqB,YAGrBA,wBAHqB;AAAA,UAIrBC,oBAJqB,YAIrBA,oBAJqB;;AAOtB,UAAKF,OAAL,EAAe;AACd,YAAMG,iBAAiB,GAAGD,oBAAoB,CAAE/C,QAAF,CAA9C;;AACA,YAAKgD,iBAAL,EAAyB;AACxB3C,UAAAA,YAAW,CAAEL,QAAF,EAAYgD,iBAAZ,CAAX;AACA;AACD,OALD,MAKO;AACN,YAAMC,qBAAqB,GAAGH,wBAAwB,CAAE9C,QAAF,CAAtD;;AACA,YAAKiD,qBAAL,EAA6B;AAC5B5C,UAAAA,YAAW,CAAE4C,qBAAF,EAAyBjD,QAAzB,CAAX;AACA;AACD;AACD,KAnBK;AAoBNF,IAAAA,cApBM,0BAoBUD,MApBV,EAoBkBqD,KApBlB,EAoB0B;AAC/BT,MAAAA,YAAY,CAAE5C,MAAF,EAAUqD,KAAV,EAAiBV,QAAQ,CAACZ,YAA1B,CAAZ;AACA,KAtBK;AAuBNhC,IAAAA,QAvBM,sBAuBoD;AAAA,UAAhDI,QAAgD,uEAArCwC,QAAQ,CAACxC,QAA4B;AAAA,UAAlBmD,eAAkB;AACzDR,MAAAA,WAAW,CAAE3C,QAAF,EAAYmD,eAAZ,CAAX;AACA,KAzBK;AA0BNhD,IAAAA,QAAQ,EAAE,kBAAED,UAAF,EAAkB;AAC3B0C,MAAAA,qBAAqB,CAAEJ,QAAQ,CAACxC,QAAX,EAAqBE,UAArB,CAArB;AACA,KA5BK;AA6BNE,IAAAA,SA7BM,qBA6BKP,MA7BL,EA6BauD,aA7Bb,EA6B6B;AAClCV,MAAAA,aAAa,CAAE,CAAEF,QAAQ,CAACxC,QAAX,CAAF,EAAyBH,MAAzB,EAAiCuD,aAAjC,CAAb;AACA;AA/BK,GAAP;AAiCA,CA1CD,CAjCuB,CAAT,EA4EVjE,cA5EU,C","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tText,\n\tTouchableWithoutFeedback,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { getBlockType } from '@wordpress/blocks';\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport styles from './block.scss';\nimport BlockEdit from '../block-edit';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockMobileToolbar from './block-mobile-toolbar';\n\nclass BlockListBlock extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.insertBlocksAfter = this.insertBlocksAfter.bind( this );\n\t\tthis.onFocus = this.onFocus.bind( this );\n\n\t\tthis.state = {\n\t\t\tisFullyBordered: false,\n\t\t};\n\t}\n\n\tonFocus() {\n\t\tif ( ! this.props.isSelected ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\tinsertBlocksAfter( blocks ) {\n\t\tthis.props.onInsertBlocks( blocks, this.props.order + 1 );\n\n\t\tif ( blocks[ 0 ] ) {\n\t\t\t// focus on the first block inserted\n\t\t\tthis.props.onSelect( blocks[ 0 ].clientId );\n\t\t}\n\t}\n\n\tgetBlockForType() {\n\t\treturn (\n\t\t\t<BlockEdit\n\t\t\t\tname={ this.props.name }\n\t\t\t\tisSelected={ this.props.isSelected }\n\t\t\t\tattributes={ this.props.attributes }\n\t\t\t\tsetAttributes={ this.props.onChange }\n\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\tonReplace={ this.props.onReplace }\n\t\t\t\tinsertBlocksAfter={ this.insertBlocksAfter }\n\t\t\t\tmergeBlocks={ this.props.mergeBlocks }\n\t\t\t\tonCaretVerticalPositionChange={ this.props.onCaretVerticalPositionChange }\n\t\t\t\tclientId={ this.props.clientId }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderBlockTitle() {\n\t\treturn (\n\t\t\t<View style={ styles.blockTitle }>\n\t\t\t\t<Text>BlockType: { this.props.name }</Text>\n\t\t\t</View>\n\t\t);\n\t}\n\n\tgetAccessibilityLabel() {\n\t\tconst { attributes, name, order, title, getAccessibilityLabelExtra } = this.props;\n\n\t\tlet blockName = '';\n\n\t\tif ( name === 'core/missing' ) { // is the block unrecognized?\n\t\t\tblockName = title;\n\t\t} else {\n\t\t\tblockName = sprintf(\n\t\t\t\t/* translators: accessibility text. %s: block name. */\n\t\t\t\t__( '%s Block' ),\n\t\t\t\ttitle, //already localized\n\t\t\t);\n\t\t}\n\n\t\tblockName += '. ' + sprintf( __( 'Row %d.' ), order + 1 );\n\n\t\tif ( getAccessibilityLabelExtra ) {\n\t\t\tconst blockAccessibilityLabel = getAccessibilityLabelExtra( attributes );\n\t\t\tblockName += blockAccessibilityLabel ? ' ' + blockAccessibilityLabel : '';\n\t\t}\n\n\t\treturn blockName;\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tborderStyle,\n\t\t\tclientId,\n\t\t\tfocusedBorderColor,\n\t\t\ticon,\n\t\t\tisSelected,\n\t\t\tisValid,\n\t\t\tshowTitle,\n\t\t\ttitle,\n\t\t} = this.props;\n\n\t\tconst borderColor = isSelected ? focusedBorderColor : 'transparent';\n\n\t\tconst accessibilityLabel = this.getAccessibilityLabel();\n\n\t\treturn (\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\tonPress={ this.onFocus }\n\t\t\t\taccessible={ ! isSelected }\n\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t>\n\t\t\t\t<View style={ [ styles.blockHolder, borderStyle, { borderColor } ] }>\n\t\t\t\t\t{ showTitle && this.renderBlockTitle() }\n\t\t\t\t\t<View\n\t\t\t\t\t\taccessibilityLabel={ accessibilityLabel }\n\t\t\t\t\t\tstyle={ [ ! isSelected && styles.blockContainer, isSelected && styles.blockContainerFocused ] }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ isValid && this.getBlockForType() }\n\t\t\t\t\t\t{ ! isValid &&\n\t\t\t\t\t\t<BlockInvalidWarning blockTitle={ title } icon={ icon } />\n\t\t\t\t\t\t}\n\t\t\t\t\t</View>\n\t\t\t\t\t{ isSelected && <BlockMobileToolbar clientId={ clientId } /> }\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId, rootClientId } ) => {\n\t\tconst {\n\t\t\tgetBlockIndex,\n\t\t\tgetBlocks,\n\t\t\tisBlockSelected,\n\t\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\t} = select( 'core/block-editor' );\n\t\tconst order = getBlockIndex( clientId, rootClientId );\n\t\tconst isSelected = isBlockSelected( clientId );\n\t\tconst isFirstBlock = order === 0;\n\t\tconst isLastBlock = order === getBlocks().length - 1;\n\t\tconst block = __unstableGetBlockWithoutInnerBlocks( clientId );\n\t\tconst { name, attributes, isValid } = block || {};\n\t\tconst blockType = getBlockType( name || 'core/missing' );\n\t\tconst title = blockType.title;\n\t\tconst icon = blockType.icon;\n\t\tconst getAccessibilityLabelExtra = blockType.__experimentalGetAccessibilityLabel;\n\n\t\treturn {\n\t\t\ticon,\n\t\t\tname: name || 'core/missing',\n\t\t\torder,\n\t\t\ttitle,\n\t\t\tattributes,\n\t\t\tblockType,\n\t\t\tisFirstBlock,\n\t\t\tisLastBlock,\n\t\t\tisSelected,\n\t\t\tisValid,\n\t\t\tgetAccessibilityLabelExtra,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps, { select } ) => {\n\t\tconst {\n\t\t\tinsertBlocks,\n\t\t\tmergeBlocks,\n\t\t\treplaceBlocks,\n\t\t\tselectBlock,\n\t\t\tupdateBlockAttributes,\n\t\t} = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tmergeBlocks( forward ) {\n\t\t\t\tconst { clientId } = ownProps;\n\t\t\t\tconst {\n\t\t\t\t\tgetPreviousBlockClientId,\n\t\t\t\t\tgetNextBlockClientId,\n\t\t\t\t} = select( 'core/block-editor' );\n\n\t\t\t\tif ( forward ) {\n\t\t\t\t\tconst nextBlockClientId = getNextBlockClientId( clientId );\n\t\t\t\t\tif ( nextBlockClientId ) {\n\t\t\t\t\t\tmergeBlocks( clientId, nextBlockClientId );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst previousBlockClientId = getPreviousBlockClientId( clientId );\n\t\t\t\t\tif ( previousBlockClientId ) {\n\t\t\t\t\t\tmergeBlocks( previousBlockClientId, clientId );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertBlocks( blocks, index ) {\n\t\t\t\tinsertBlocks( blocks, index, ownProps.rootClientId );\n\t\t\t},\n\t\t\tonSelect( clientId = ownProps.clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t\tonChange: ( attributes ) => {\n\t\t\t\tupdateBlockAttributes( ownProps.clientId, attributes );\n\t\t\t},\n\t\t\tonReplace( blocks, indexToSelect ) {\n\t\t\t\treplaceBlocks( [ ownProps.clientId ], blocks, indexToSelect );\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockListBlock );\n"]}