{"version":3,"sources":["@wordpress/block-editor/src/components/block-actions/index.js"],"names":["BlockActions","canDuplicate","canInsertDefaultBlock","children","isLocked","onDuplicate","onGroup","onInsertAfter","onInsertBefore","onRemove","onUngroup","select","props","canInsertBlockType","getBlockRootClientId","getBlocksByClientId","getTemplateLock","getDefaultBlockName","blocks","clientIds","rootClientId","block","name","extraProps","dispatch","insertBlocks","multiSelect","removeBlocks","insertDefaultBlock","replaceBlocks","getBlockIndex","lastSelectedIndex","clonedBlocks","map","length","clientId","firstSelectedIndex","getGroupingBlockName","groupingBlockName","newBlocks","innerBlocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { castArray, first, last, every } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { cloneBlock, hasBlockSupport, switchToBlockType } from '@wordpress/blocks';\n\nfunction BlockActions( {\n\tcanDuplicate,\n\tcanInsertDefaultBlock,\n\tchildren,\n\tisLocked,\n\tonDuplicate,\n\tonGroup,\n\tonInsertAfter,\n\tonInsertBefore,\n\tonRemove,\n\tonUngroup,\n} ) {\n\treturn children( {\n\t\tcanDuplicate,\n\t\tcanInsertDefaultBlock,\n\t\tisLocked,\n\t\tonDuplicate,\n\t\tonGroup,\n\t\tonInsertAfter,\n\t\tonInsertBefore,\n\t\tonRemove,\n\t\tonUngroup,\n\t} );\n}\n\nexport default compose( [\n\twithSelect( ( select, props ) => {\n\t\tconst {\n\t\t\tcanInsertBlockType,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlocksByClientId,\n\t\t\tgetTemplateLock,\n\t\t} = select( 'core/block-editor' );\n\t\tconst { getDefaultBlockName } = select( 'core/blocks' );\n\n\t\tconst blocks = getBlocksByClientId( props.clientIds );\n\t\tconst rootClientId = getBlockRootClientId( props.clientIds[ 0 ] );\n\t\tconst canDuplicate = every( blocks, ( block ) => {\n\t\t\treturn (\n\t\t\t\t!! block &&\n\t\t\t\thasBlockSupport( block.name, 'multiple', true ) &&\n\t\t\t\tcanInsertBlockType( block.name, rootClientId )\n\t\t\t);\n\t\t} );\n\n\t\tconst canInsertDefaultBlock = canInsertBlockType(\n\t\t\tgetDefaultBlockName(),\n\t\t\trootClientId\n\t\t);\n\n\t\treturn {\n\t\t\tblocks,\n\t\t\tcanDuplicate,\n\t\t\tcanInsertDefaultBlock,\n\t\t\textraProps: props,\n\t\t\tisLocked: !! getTemplateLock( rootClientId ),\n\t\t\trootClientId,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, props, { select } ) => {\n\t\tconst {\n\t\t\tclientIds,\n\t\t\trootClientId,\n\t\t\tblocks,\n\t\t\tisLocked,\n\t\t\tcanDuplicate,\n\t\t} = props;\n\n\t\tconst {\n\t\t\tinsertBlocks,\n\t\t\tmultiSelect,\n\t\t\tremoveBlocks,\n\t\t\tinsertDefaultBlock,\n\t\t\treplaceBlocks,\n\t\t} = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tonDuplicate() {\n\t\t\t\tif ( ! canDuplicate ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\tconst lastSelectedIndex = getBlockIndex( last( castArray( clientIds ) ), rootClientId );\n\t\t\t\tconst clonedBlocks = blocks.map( ( block ) => cloneBlock( block ) );\n\t\t\t\tinsertBlocks(\n\t\t\t\t\tclonedBlocks,\n\t\t\t\t\tlastSelectedIndex + 1,\n\t\t\t\t\trootClientId\n\t\t\t\t);\n\t\t\t\tif ( clonedBlocks.length > 1 ) {\n\t\t\t\t\tmultiSelect(\n\t\t\t\t\t\tfirst( clonedBlocks ).clientId,\n\t\t\t\t\t\tlast( clonedBlocks ).clientId\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonRemove() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tremoveBlocks( clientIds );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertBefore() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\t\tconst firstSelectedIndex = getBlockIndex( first( castArray( clientIds ) ), rootClientId );\n\t\t\t\t\tinsertDefaultBlock( {}, rootClientId, firstSelectedIndex );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertAfter() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\t\tconst lastSelectedIndex = getBlockIndex( last( castArray( clientIds ) ), rootClientId );\n\t\t\t\t\tinsertDefaultBlock( {}, rootClientId, lastSelectedIndex + 1 );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonGroup() {\n\t\t\t\tif ( ! blocks.length ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst {\n\t\t\t\t\tgetGroupingBlockName,\n\t\t\t\t} = select( 'core/blocks' );\n\n\t\t\t\tconst groupingBlockName = getGroupingBlockName();\n\n\t\t\t\t// Activate the `transform` on `core/group` which does the conversion\n\t\t\t\tconst newBlocks = switchToBlockType( blocks, groupingBlockName );\n\n\t\t\t\tif ( ! newBlocks ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treplaceBlocks(\n\t\t\t\t\tclientIds,\n\t\t\t\t\tnewBlocks\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tonUngroup() {\n\t\t\t\tif ( ! blocks.length ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst innerBlocks = blocks[ 0 ].innerBlocks;\n\n\t\t\t\tif ( ! innerBlocks.length ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treplaceBlocks(\n\t\t\t\t\tclientIds,\n\t\t\t\t\tinnerBlocks\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockActions );\n"]}