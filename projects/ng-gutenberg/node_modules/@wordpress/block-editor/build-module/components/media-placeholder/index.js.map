{"version":3,"sources":["@wordpress/block-editor/src/components/media-placeholder/index.js"],"names":["every","get","isArray","noop","startsWith","classnames","Button","FormFileUpload","Placeholder","DropZone","IconButton","withFilters","__","Component","compose","withSelect","MediaUpload","MediaUploadCheck","URLPopover","InsertFromURLPopover","src","onChange","onSubmit","onClose","MediaPlaceholder","arguments","state","isURLInputVisible","onChangeSrc","bind","onSubmitSrc","onUpload","onFilesUpload","openURLInput","closeURLInput","allowedTypes","props","allowedType","setState","value","prevProps","event","target","preventDefault","onSelectURL","files","addToGallery","mediaUpload","multiple","onError","onSelect","setMedia","currentValue","newMedia","concat","media","filesList","onFileChange","content","onClick","className","icon","isAppender","labels","onDoubleClick","mediaPreview","notices","children","instructions","title","undefined","isOneType","length","isAudio","isImage","isVideo","placeholderClassName","disableDropZone","onHTMLDrop","onCancel","accept","mediaLibraryButton","onlyAllowsImages","map","id","open","stopPropagation","renderDropZone","openFileDialog","renderUrlSelectionUI","renderCancelLink","renderPlaceholder","dropZoneUIOnly","renderMediaUploadChecked","applyWithSelect","select","getSettings","__experimentalMediaUpload"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tevery,\n\tget,\n\tisArray,\n\tnoop,\n\tstartsWith,\n} from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tButton,\n\tFormFileUpload,\n\tPlaceholder,\n\tDropZone,\n\tIconButton,\n\twithFilters,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport MediaUpload from '../media-upload';\nimport MediaUploadCheck from '../media-upload/check';\nimport URLPopover from '../url-popover';\n\nconst InsertFromURLPopover = ( { src, onChange, onSubmit, onClose } ) => (\n\t<URLPopover onClose={ onClose }>\n\t\t<form\n\t\t\tclassName=\"editor-media-placeholder__url-input-form block-editor-media-placeholder__url-input-form\"\n\t\t\tonSubmit={ onSubmit }\n\t\t>\n\t\t\t<input\n\t\t\t\tclassName=\"editor-media-placeholder__url-input-field block-editor-media-placeholder__url-input-field\"\n\t\t\t\ttype=\"url\"\n\t\t\t\taria-label={ __( 'URL' ) }\n\t\t\t\tplaceholder={ __( 'Paste or type URL' ) }\n\t\t\t\tonChange={ onChange }\n\t\t\t\tvalue={ src }\n\t\t\t/>\n\t\t\t<IconButton\n\t\t\t\tclassName=\"editor-media-placeholder__url-input-submit-button block-editor-media-placeholder__url-input-submit-button\"\n\t\t\t\ticon=\"editor-break\"\n\t\t\t\tlabel={ __( 'Apply' ) }\n\t\t\t\ttype=\"submit\"\n\t\t\t/>\n\t\t</form>\n\t</URLPopover>\n);\n\nexport class MediaPlaceholder extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tsrc: '',\n\t\t\tisURLInputVisible: false,\n\t\t};\n\t\tthis.onChangeSrc = this.onChangeSrc.bind( this );\n\t\tthis.onSubmitSrc = this.onSubmitSrc.bind( this );\n\t\tthis.onUpload = this.onUpload.bind( this );\n\t\tthis.onFilesUpload = this.onFilesUpload.bind( this );\n\t\tthis.openURLInput = this.openURLInput.bind( this );\n\t\tthis.closeURLInput = this.closeURLInput.bind( this );\n\t}\n\n\tonlyAllowsImages() {\n\t\tconst { allowedTypes } = this.props;\n\t\tif ( ! allowedTypes ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn every( allowedTypes, ( allowedType ) => {\n\t\t\treturn allowedType === 'image' || startsWith( allowedType, 'image/' );\n\t\t} );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setState( { src: get( this.props.value, [ 'src' ], '' ) } );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( get( prevProps.value, [ 'src' ], '' ) !== get( this.props.value, [ 'src' ], '' ) ) {\n\t\t\tthis.setState( { src: get( this.props.value, [ 'src' ], '' ) } );\n\t\t}\n\t}\n\n\tonChangeSrc( event ) {\n\t\tthis.setState( { src: event.target.value } );\n\t}\n\n\tonSubmitSrc( event ) {\n\t\tevent.preventDefault();\n\t\tif ( this.state.src && this.props.onSelectURL ) {\n\t\t\tthis.props.onSelectURL( this.state.src );\n\t\t\tthis.closeURLInput();\n\t\t}\n\t}\n\n\tonUpload( event ) {\n\t\tthis.onFilesUpload( event.target.files );\n\t}\n\n\tonFilesUpload( files ) {\n\t\tconst {\n\t\t\taddToGallery,\n\t\t\tallowedTypes,\n\t\t\tmediaUpload,\n\t\t\tmultiple,\n\t\t\tonError,\n\t\t\tonSelect,\n\t\t\tvalue = [],\n\t\t} = this.props;\n\t\tlet setMedia;\n\t\tif ( multiple ) {\n\t\t\tif ( addToGallery ) {\n\t\t\t\tconst currentValue = value;\n\t\t\t\tsetMedia = ( newMedia ) => {\n\t\t\t\t\tonSelect( currentValue.concat( newMedia ) );\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tsetMedia = onSelect;\n\t\t\t}\n\t\t} else {\n\t\t\tsetMedia = ( [ media ] ) => onSelect( media );\n\t\t}\n\t\tmediaUpload( {\n\t\t\tallowedTypes,\n\t\t\tfilesList: files,\n\t\t\tonFileChange: setMedia,\n\t\t\tonError,\n\t\t} );\n\t}\n\n\topenURLInput() {\n\t\tthis.setState( { isURLInputVisible: true } );\n\t}\n\n\tcloseURLInput() {\n\t\tthis.setState( { isURLInputVisible: false } );\n\t}\n\n\trenderPlaceholder( content, onClick ) {\n\t\tconst {\n\t\t\tallowedTypes = [],\n\t\t\tclassName,\n\t\t\ticon,\n\t\t\tisAppender,\n\t\t\tlabels = {},\n\t\t\tonDoubleClick,\n\t\t\tmediaPreview,\n\t\t\tnotices,\n\t\t\tonSelectURL,\n\t\t\tmediaUpload,\n\t\t\tchildren,\n\t\t} = this.props;\n\n\t\tlet instructions = labels.instructions;\n\t\tlet title = labels.title;\n\n\t\tif ( ! mediaUpload && ! onSelectURL ) {\n\t\t\tinstructions = __( 'To edit this block, you need permission to upload media.' );\n\t\t}\n\n\t\tif ( instructions === undefined || title === undefined ) {\n\t\t\tconst isOneType = 1 === allowedTypes.length;\n\t\t\tconst isAudio = isOneType && 'audio' === allowedTypes[ 0 ];\n\t\t\tconst isImage = isOneType && 'image' === allowedTypes[ 0 ];\n\t\t\tconst isVideo = isOneType && 'video' === allowedTypes[ 0 ];\n\n\t\t\tif ( instructions === undefined && mediaUpload ) {\n\t\t\t\tinstructions = __( 'Upload a media file or pick one from your media library.' );\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\tinstructions = __( 'Upload an audio file, pick one from your media library, or add one with a URL.' );\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\tinstructions = __( 'Upload an image file, pick one from your media library, or add one with a URL.' );\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\tinstructions = __( 'Upload a video file, pick one from your media library, or add one with a URL.' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( title === undefined ) {\n\t\t\t\ttitle = __( 'Media' );\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\ttitle = __( 'Audio' );\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\ttitle = __( 'Image' );\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\ttitle = __( 'Video' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst placeholderClassName = classnames(\n\t\t\t'block-editor-media-placeholder',\n\t\t\t'editor-media-placeholder',\n\t\t\tclassName,\n\t\t\t{ 'is-appender': isAppender }\n\t\t);\n\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ title }\n\t\t\t\tinstructions={ instructions }\n\t\t\t\tclassName={ placeholderClassName }\n\t\t\t\tnotices={ notices }\n\t\t\t\tonClick={ onClick }\n\t\t\t\tonDoubleClick={ onDoubleClick }\n\t\t\t\tpreview={ mediaPreview }\n\t\t\t>\n\t\t\t\t{ content }\n\t\t\t\t{ children }\n\t\t\t</Placeholder>\n\t\t);\n\t}\n\n\trenderDropZone() {\n\t\tconst { disableDropZone, onHTMLDrop = noop } = this.props;\n\n\t\tif ( disableDropZone ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<DropZone\n\t\t\t\tonFilesDrop={ this.onFilesUpload }\n\t\t\t\tonHTMLDrop={ onHTMLDrop }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderCancelLink() {\n\t\tconst {\n\t\t\tonCancel,\n\t\t} = this.props;\n\t\treturn ( onCancel &&\n\t\t\t<Button\n\t\t\t\tclassName=\"block-editor-media-placeholder__cancel-button\"\n\t\t\t\ttitle={ __( 'Cancel' ) }\n\t\t\t\tisLink\n\t\t\t\tonClick={ onCancel }\n\t\t\t>\n\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t</Button>\n\t\t);\n\t}\n\n\trenderUrlSelectionUI() {\n\t\tconst {\n\t\t\tonSelectURL,\n\t\t} = this.props;\n\t\tif ( ! onSelectURL ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst {\n\t\t\tisURLInputVisible,\n\t\t\tsrc,\n\t\t} = this.state;\n\t\treturn (\n\t\t\t<div className=\"editor-media-placeholder__url-input-container block-editor-media-placeholder__url-input-container\">\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"editor-media-placeholder__button block-editor-media-placeholder__button\"\n\t\t\t\t\tonClick={ this.openURLInput }\n\t\t\t\t\tisToggled={ isURLInputVisible }\n\t\t\t\t\tisLarge\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Insert from URL' ) }\n\t\t\t\t</Button>\n\t\t\t\t{ isURLInputVisible && (\n\t\t\t\t\t<InsertFromURLPopover\n\t\t\t\t\t\tsrc={ src }\n\t\t\t\t\t\tonChange={ this.onChangeSrc }\n\t\t\t\t\t\tonSubmit={ this.onSubmitSrc }\n\t\t\t\t\t\tonClose={ this.closeURLInput }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderMediaUploadChecked() {\n\t\tconst {\n\t\t\taccept,\n\t\t\taddToGallery,\n\t\t\tallowedTypes = [],\n\t\t\tisAppender,\n\t\t\tmediaUpload,\n\t\t\tmultiple = false,\n\t\t\tonSelect,\n\t\t\tvalue = {},\n\t\t} = this.props;\n\n\t\tconst mediaLibraryButton = (\n\t\t\t<MediaUpload\n\t\t\t\taddToGallery={ addToGallery }\n\t\t\t\tgallery={ multiple && this.onlyAllowsImages() }\n\t\t\t\tmultiple={ multiple }\n\t\t\t\tonSelect={ onSelect }\n\t\t\t\tallowedTypes={ allowedTypes }\n\t\t\t\tvalue={\n\t\t\t\t\tisArray( value ) ?\n\t\t\t\t\t\tvalue.map( ( { id } ) => id ) :\n\t\t\t\t\t\tvalue.id\n\t\t\t\t}\n\t\t\t\trender={ ( { open } ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisLarge\n\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t'editor-media-placeholder__button',\n\t\t\t\t\t\t\t\t'editor-media-placeholder__media-library-button'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tonClick={ ( event ) => {\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t\topen();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Media Library' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\n\t\tif ( mediaUpload && isAppender ) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t{ this.renderDropZone() }\n\t\t\t\t\t<FormFileUpload\n\t\t\t\t\t\tonChange={ this.onUpload }\n\t\t\t\t\t\taccept={ accept }\n\t\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t\t\trender={ ( { openFileDialog } ) => {\n\t\t\t\t\t\t\tconst content = (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\tisLarge\n\t\t\t\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t\t\t\t'block-editor-media-placeholder__button',\n\t\t\t\t\t\t\t\t\t\t\t'editor-media-placeholder__button',\n\t\t\t\t\t\t\t\t\t\t\t'block-editor-media-placeholder__upload-button'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\ticon=\"upload\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Upload' ) }\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t{ mediaLibraryButton }\n\t\t\t\t\t\t\t\t\t{ this.renderUrlSelectionUI() }\n\t\t\t\t\t\t\t\t\t{ this.renderCancelLink() }\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn this.renderPlaceholder( content, openFileDialog );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\n\t\tif ( mediaUpload ) {\n\t\t\tconst content = (\n\t\t\t\t<>\n\t\t\t\t\t{ this.renderDropZone() }\n\t\t\t\t\t<FormFileUpload\n\t\t\t\t\t\tisLarge\n\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t'block-editor-media-placeholder__button',\n\t\t\t\t\t\t\t'editor-media-placeholder__button',\n\t\t\t\t\t\t\t'block-editor-media-placeholder__upload-button'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonChange={ this.onUpload }\n\t\t\t\t\t\taccept={ accept }\n\t\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Upload' ) }\n\t\t\t\t\t</FormFileUpload>\n\t\t\t\t\t{ mediaLibraryButton }\n\t\t\t\t\t{ this.renderUrlSelectionUI() }\n\t\t\t\t\t{ this.renderCancelLink() }\n\t\t\t\t</>\n\t\t\t);\n\t\t\treturn this.renderPlaceholder( content );\n\t\t}\n\n\t\treturn this.renderPlaceholder( mediaLibraryButton );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tdropZoneUIOnly,\n\t\t} = this.props;\n\n\t\tif ( dropZoneUIOnly ) {\n\t\t\treturn (\n\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t{ this.renderDropZone() }\n\t\t\t\t</MediaUploadCheck>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<MediaUploadCheck\n\t\t\t\tfallback={ this.renderPlaceholder( this.renderUrlSelectionUI() ) }\n\t\t\t>\n\t\t\t\t{ this.renderMediaUploadChecked() }\n\t\t\t</MediaUploadCheck>\n\t\t);\n\t}\n}\n\nconst applyWithSelect = withSelect( ( select ) => {\n\tconst { getSettings } = select( 'core/block-editor' );\n\n\treturn {\n\t\tmediaUpload: getSettings().__experimentalMediaUpload,\n\t};\n} );\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/master/packages/block-editor/src/components/media-placeholder/README.md\n */\nexport default compose(\n\tapplyWithSelect,\n\twithFilters( 'editor.MediaPlaceholder' ),\n)( MediaPlaceholder );\n"]}