{"version":3,"sources":["@wordpress/block-editor/src/components/rich-text/index.native.js"],"names":["classnames","View","RawHTML","withDispatch","withSelect","pasteHandler","isUnmodifiedDefaultBlock","withInstanceId","compose","RichText","Autocomplete","BlockFormatControls","FormatToolbar","withBlockEditContext","wrapperClasses","classes","RichTextWraper","children","tagName","originalValue","value","originalOnChange","onChange","selectionStart","selectionEnd","onSelectionChange","multiline","inlineToolbar","wrapperClassName","className","autocompleters","onReplace","onRemove","onMerge","onSplit","isCaretWithinFormattedText","onEnterFormattedText","onExitFormattedText","canUserUseUnfilteredHTML","originalIsSelected","isSelected","onCreateUndoLevel","placeholder","experimentalProps","adjustedValue","adjustedOnChange","RichTextContainer","ownProps","clientId","onCaretVerticalPositionChange","blockIsSelected","undefined","select","instanceId","identifier","getFormatTypes","getSelectionStart","getSelectionEnd","__unstableGetBlockWithoutInnerBlocks","attributeKey","block","shouldBlurOnUnmount","formatTypes","offset","dispatch","__unstableMarkLastChangeAsPersistent","selectionChange","start","end","Content","format","Tag","props","content","html","MultilineTag","isEmpty","Array","isArray","length","defaultProps","RichTextShortcut","RichTextToolbarButton","__unstableRichTextInputEvent"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { RawHTML } from '@wordpress/element';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { pasteHandler, isUnmodifiedDefaultBlock } from '@wordpress/blocks';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { RichText } from '@wordpress/rich-text';\n\n/**\n * Internal dependencies\n */\nimport Autocomplete from '../autocomplete';\nimport BlockFormatControls from '../block-format-controls';\nimport FormatToolbar from './format-toolbar';\nimport { withBlockEditContext } from '../block-edit/context';\n\nconst wrapperClasses = 'editor-rich-text block-editor-rich-text';\nconst classes = 'editor-rich-text__editable block-editor-rich-text__editable';\n\nfunction RichTextWraper( {\n\tchildren,\n\ttagName,\n\tvalue: originalValue,\n\tonChange: originalOnChange,\n\tselectionStart,\n\tselectionEnd,\n\tonSelectionChange,\n\tmultiline,\n\tinlineToolbar,\n\twrapperClassName,\n\tclassName,\n\tautocompleters,\n\tonReplace,\n\tonRemove,\n\tonMerge,\n\tonSplit,\n\tisCaretWithinFormattedText,\n\tonEnterFormattedText,\n\tonExitFormattedText,\n\tcanUserUseUnfilteredHTML,\n\tisSelected: originalIsSelected,\n\tonCreateUndoLevel,\n\tplaceholder,\n\t// From experimental filter.\n\t...experimentalProps\n} ) {\n\tconst adjustedValue = originalValue;\n\tconst adjustedOnChange = originalOnChange;\n\n\treturn (\n\t\t<RichText\n\t\t\t{ ...experimentalProps }\n\t\t\tvalue={ adjustedValue }\n\t\t\tonChange={ adjustedOnChange }\n\t\t\tselectionStart={ selectionStart }\n\t\t\tselectionEnd={ selectionEnd }\n\t\t\tonSelectionChange={ onSelectionChange }\n\t\t\ttagName={ tagName }\n\t\t\twrapperClassName={ classnames( wrapperClasses, wrapperClassName ) }\n\t\t\tclassName={ classnames( classes, className ) }\n\t\t\tplaceholder={ placeholder }\n\t\t\t__unstableIsSelected={ originalIsSelected }\n\t\t\t//__unstablePatterns={ getPatterns() }\n\t\t\t//__unstableEnterPatterns={ getEnterPatterns() }\n\t\t\t__unstablePasteHandler={ pasteHandler }\n\t\t\t__unstableAutocomplete={ Autocomplete }\n\t\t\t__unstableAutocompleters={ autocompleters }\n\t\t\t__unstableOnReplace={ onReplace }\n\t\t\t__unstableOnRemove={ onRemove }\n\t\t\t__unstableOnMerge={ onMerge }\n\t\t\t__unstableOnSplit={ onSplit }\n\t\t\t__unstableMultiline={ multiline }\n\t\t\t__unstableIsCaretWithinFormattedText={ isCaretWithinFormattedText }\n\t\t\t__unstableOnEnterFormattedText={ onEnterFormattedText }\n\t\t\t__unstableOnExitFormattedText={ onExitFormattedText }\n\t\t\t__unstableCanUserUseUnfilteredHTML={ canUserUseUnfilteredHTML }\n\t\t\t__unstableOnCreateUndoLevel={ onCreateUndoLevel }\n\t\t>\n\t\t\t{ ( { isSelected, value, onChange } ) =>\n\t\t\t\t<View>\n\t\t\t\t\t{ children && children( { value, onChange } ) }\n\t\t\t\t\t{ isSelected && ! inlineToolbar && (\n\t\t\t\t\t\t<BlockFormatControls>\n\t\t\t\t\t\t\t<FormatToolbar />\n\t\t\t\t\t\t</BlockFormatControls>\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t}\n\t\t</RichText>\n\t);\n}\n\nconst RichTextContainer = compose( [\n\twithInstanceId,\n\twithBlockEditContext( ( { clientId, onCaretVerticalPositionChange, isSelected }, ownProps ) => {\n\t\treturn {\n\t\t\tclientId,\n\t\t\tblockIsSelected: ownProps.isSelected !== undefined ? ownProps.isSelected : isSelected,\n\t\t\tonCaretVerticalPositionChange,\n\t\t};\n\t} ),\n\twithSelect( ( select, {\n\t\tclientId,\n\t\tinstanceId,\n\t\tidentifier = instanceId,\n\t\tisSelected,\n\t\tblockIsSelected,\n\t} ) => {\n\t\tconst { getFormatTypes } = select( 'core/rich-text' );\n\t\tconst {\n\t\t\tgetSelectionStart,\n\t\t\tgetSelectionEnd,\n\t\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst selectionStart = getSelectionStart();\n\t\tconst selectionEnd = getSelectionEnd();\n\n\t\tif ( isSelected === undefined ) {\n\t\t\tisSelected = (\n\t\t\t\tselectionStart.clientId === clientId &&\n\t\t\t\tselectionStart.attributeKey === identifier\n\t\t\t);\n\t\t}\n\n\t\t// If the block of this RichText is unmodified then it's a candidate for replacing when adding a new block.\n\t\t// In order to fix https://github.com/wordpress-mobile/gutenberg-mobile/issues/1126, let's blur on unmount in that case.\n\t\t// This apparently assumes functionality the BlockHlder actually\n\t\tconst block = clientId && __unstableGetBlockWithoutInnerBlocks( clientId );\n\t\tconst shouldBlurOnUnmount = block && isSelected && isUnmodifiedDefaultBlock( block );\n\n\t\treturn {\n\t\t\tformatTypes: getFormatTypes(),\n\t\t\tselectionStart: isSelected ? selectionStart.offset : undefined,\n\t\t\tselectionEnd: isSelected ? selectionEnd.offset : undefined,\n\t\t\tisSelected,\n\t\t\tblockIsSelected,\n\t\t\tshouldBlurOnUnmount,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, {\n\t\tclientId,\n\t\tinstanceId,\n\t\tidentifier = instanceId,\n\t} ) => {\n\t\tconst {\n\t\t\t__unstableMarkLastChangeAsPersistent,\n\t\t\tselectionChange,\n\t\t} = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tonCreateUndoLevel: __unstableMarkLastChangeAsPersistent,\n\t\t\tonSelectionChange( start, end ) {\n\t\t\t\tselectionChange( clientId, identifier, start, end );\n\t\t\t},\n\t\t};\n\t} ),\n] )( RichTextWraper );\n\nRichTextContainer.Content = ( { value, format, tagName: Tag, multiline, ...props } ) => {\n\tlet content;\n\tlet html = value;\n\tlet MultilineTag;\n\n\tif ( multiline === true || multiline === 'p' || multiline === 'li' ) {\n\t\tMultilineTag = multiline === true ? 'p' : multiline;\n\t}\n\n\tif ( ! html && MultilineTag ) {\n\t\thtml = `<${ MultilineTag }></${ MultilineTag }>`;\n\t}\n\n\tswitch ( format ) {\n\t\tcase 'string':\n\t\t\tcontent = <RawHTML>{ html }</RawHTML>;\n\t\t\tbreak;\n\t}\n\n\tif ( Tag ) {\n\t\treturn <Tag { ...props }>{ content }</Tag>;\n\t}\n\n\treturn content;\n};\n\nRichTextContainer.isEmpty = ( value = '' ) => {\n\t// Handle deprecated `children` and `node` sources.\n\tif ( Array.isArray( value ) ) {\n\t\treturn ! value || value.length === 0;\n\t}\n\n\treturn value.length === 0;\n};\n\nRichTextContainer.Content.defaultProps = {\n\tformat: 'string',\n\tvalue: '',\n};\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/master/packages/block-editor/src/components/rich-text/README.md\n */\nexport default RichTextContainer;\nexport { RichTextShortcut } from './shortcut';\nexport { RichTextToolbarButton } from './toolbar-button';\nexport { __unstableRichTextInputEvent } from './input-event';\n"]}