{"version":3,"sources":["@wordpress/block-library/src/file/transforms.js"],"names":["transforms","from","type","isMatch","files","length","priority","transform","blocks","forEach","file","blobURL","push","href","fileName","name","textLinkHref","attributes","src","caption","id","url","to","getMedia","media","mime_type"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { includes } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { createBlobURL } from '@wordpress/blob';\nimport { createBlock } from '@wordpress/blocks';\nimport { select } from '@wordpress/data';\n\nconst transforms = {\n\tfrom: [\n\t\t{\n\t\t\ttype: 'files',\n\t\t\tisMatch( files ) {\n\t\t\t\treturn files.length > 0;\n\t\t\t},\n\t\t\t// We define a lower priorty (higher number) than the default of 10. This\n\t\t\t// ensures that the File block is only created as a fallback.\n\t\t\tpriority: 15,\n\t\t\ttransform: ( files ) => {\n\t\t\t\tconst blocks = [];\n\n\t\t\t\tfiles.forEach( ( file ) => {\n\t\t\t\t\tconst blobURL = createBlobURL( file );\n\n\t\t\t\t\t// File will be uploaded in componentDidMount()\n\t\t\t\t\tblocks.push( createBlock( 'core/file', {\n\t\t\t\t\t\thref: blobURL,\n\t\t\t\t\t\tfileName: file.name,\n\t\t\t\t\t\ttextLinkHref: blobURL,\n\t\t\t\t\t} ) );\n\t\t\t\t} );\n\n\t\t\t\treturn blocks;\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/audio' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.src,\n\t\t\t\t\tfileName: attributes.caption,\n\t\t\t\t\ttextLinkHref: attributes.src,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/video' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.src,\n\t\t\t\t\tfileName: attributes.caption,\n\t\t\t\t\ttextLinkHref: attributes.src,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/image' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.url,\n\t\t\t\t\tfileName: attributes.caption,\n\t\t\t\t\ttextLinkHref: attributes.url,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t],\n\tto: [\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/audio' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( 'core' );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && includes( media.mime_type, 'audio' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/audio', {\n\t\t\t\t\tsrc: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/video' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( 'core' );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && includes( media.mime_type, 'video' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/video', {\n\t\t\t\t\tsrc: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/image' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( 'core' );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && includes( media.mime_type, 'image' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/image', {\n\t\t\t\t\turl: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t],\n};\n\nexport default transforms;\n"]}