{"version":3,"sources":["@wordpress/block-library/src/video/video-player.native.js"],"names":["Component","Icon","__","View","TouchableOpacity","Platform","Linking","Alert","default","VideoPlayer","styles","PlayIcon","Video","arguments","isIOS","OS","state","isFullScreen","videoContainerHeight","onPressPlay","bind","onVideoLayout","event","height","nativeEvent","layout","setState","player","presentFullscreenPlayer","source","props","uri","openURL","url","canOpenURL","then","supported","alert","window","console","warn","catch","err","error","isSelected","style","showPlayButton","videoContainer","ref","overlayContainer","blackOverlay","playIcon","size"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { Icon } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * External dependencies\n */\nimport { View, TouchableOpacity, Platform, Linking, Alert } from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * Internal dependencies\n */\nimport styles from './video-player.scss';\nimport PlayIcon from './gridicon-play';\n\nclass Video extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.isIOS = Platform.OS === 'ios';\n\t\tthis.state = {\n\t\t\tisFullScreen: false,\n\t\t\tvideoContainerHeight: 0,\n\t\t};\n\t\tthis.onPressPlay = this.onPressPlay.bind( this );\n\t\tthis.onVideoLayout = this.onVideoLayout.bind( this );\n\t}\n\n\tonVideoLayout( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.videoContainerHeight ) {\n\t\t\tthis.setState( { videoContainerHeight: height } );\n\t\t}\n\t}\n\n\tonPressPlay() {\n\t\tif ( this.isIOS ) {\n\t\t\tif ( this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t}\n\t\t} else {\n\t\t\tconst { source } = this.props;\n\t\t\tif ( source && source.uri ) {\n\t\t\t\tthis.openURL( source.uri );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Tries opening the URL outside of the app\n\topenURL( url ) {\n\t\tLinking.canOpenURL( url ).then( ( supported ) => {\n\t\t\tif ( ! supported ) {\n\t\t\t\tAlert.alert( __( 'Problem opening the video' ), __( 'No application can handle this request. Please install a Web browser.' ) );\n\t\t\t\twindow.console.warn( 'No application found that can open the video with URL: ' + url );\n\t\t\t} else {\n\t\t\t\treturn Linking.openURL( url );\n\t\t\t}\n\t\t} ).catch( ( err ) => {\n\t\t\tAlert.alert( __( 'Problem opening the video' ), __( 'An unknown error occurred. Please try again.' ) );\n\t\t\twindow.console.error( 'An error occurred while opening the video URL: ' + url, err );\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isSelected, style } = this.props;\n\t\tconst { isFullScreen, videoContainerHeight } = this.state;\n\t\tconst showPlayButton = videoContainerHeight > 0;\n\n\t\treturn (\n\t\t\t<View style={ styles.videoContainer }>\n\t\t\t\t<VideoPlayer\n\t\t\t\t\t{ ...this.props }\n\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t} }\n\t\t\t\t\t// Using built-in player controls is messing up the layout on iOS.\n\t\t\t\t\t// So we are setting controls=false and adding a play button that\n\t\t\t\t\t// will trigger presentFullscreenPlayer()\n\t\t\t\t\tcontrols={ false }\n\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\tpaused={ ! isFullScreen }\n\t\t\t\t\tonLayout={ this.onVideoLayout }\n\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: true } );\n\t\t\t\t\t} }\n\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: false } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ showPlayButton &&\n\t\t\t\t// If we add the play icon as a subview to VideoPlayer then react-native-video decides to show control buttons\n\t\t\t\t// even if we set controls={ false }, so we are adding our play button as a sibling overlay view.\n\t\t\t\t<TouchableOpacity disabled={ ! isSelected } onPress={ this.onPressPlay } style={ [ style, styles.overlayContainer ] }>\n\t\t\t\t\t<View style={ styles.blackOverlay } />\n\t\t\t\t\t<Icon icon={ PlayIcon } style={ styles.playIcon } size={ styles.playIcon.size } />\n\t\t\t\t</TouchableOpacity>\n\t\t\t\t}\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default Video;\n"]}